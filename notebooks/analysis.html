<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TTC Bus Delay Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="analysis_files/libs/quarto-html/quarto.js"></script>
<script src="analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TTC Bus Delay Report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="authors" class="level2">
<h2 class="anchored" data-anchor-id="authors">Authors</h2>
<p>Agam Sanghera, Ashita Diwan, Cheng Zhang, Yichun Liu</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This report examines the 2024 TTC bus delay dataset to forecast delay times based on factors such as route, incident type, location, and time. We aim to classify delays into short, medium, and long categories using a logistic regression model. This study acts as a foundation for the implementation of real-time prediction models that could aid the Toronto Transit Commission in resource allocation and improving schedule adherence.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Public transportation systems, such as Toronto’s TTC, are essential for facilitating commuter mobility. However, delays are unavoidable and can affect the efficiency of services. Anticipating these delays may enhance operational decision-making and increase commuter satisfaction. The objective of this analysis is to identify the primary factors contributing to delays and to accurately forecast the duration of these delays by utilizing route, incident types, location, and time-related features as predictors.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>The data for this analysis was sourced from the <a href="http://open.toronto.ca">open.toronto.ca</a> website, with a specific emphasis on the bus delay data for the year 2024. This dataset contains multiple incident reports, including information on route number, delay duration, incident type, and incident location. Raw data can be found <a href="https://open.toronto.ca/dataset/ttc-bus-delay-data/">here</a>.</p>
</section>
<section id="eda-analysis" class="level2">
<h2 class="anchored" data-anchor-id="eda-analysis">EDA Analysis</h2>
<p>We will first conduct an EDA analysis on the data. The steps include: 1. <strong>Loading and Preprocessing Data:</strong> Handling missing values, converting timestamp data to day parts, and cleaning data fields irrelevant to our delay analysis. 2. <strong>Visualization:</strong> Analyze the distribution of delays, identify top routes and locations with frequent delay incidents, and visualize delays based on day and incident type.</p>
<div id="62137a60-6ccb-4eb9-a06a-bac32d3d1ec5" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code block will be used for all library imports. </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simplify working with large datasets in Altair</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>alt.data_transformers.enable(<span class="st">'vegafusion'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>DataTransformerRegistry.enable('vegafusion')</code></pre>
</div>
</div>
<section id="loading-and-fixing-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-fixing-data">Loading and Fixing Data</h3>
<div id="e2e179f6-d233-46c1-8955-016f62535a7f" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's load the data.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the Dates column is parsed through date argument to make sure it is seen as datetime object.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ttc <span class="op">=</span> pd.read_csv(<span class="st">'../data/raw/ttc-bus-delay-data-2024.csv'</span>, parse_dates<span class="op">=</span>[<span class="st">'Date'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m3/7mxrzzgs65x1zsl77zk_xn640000gn/T/ipykernel_5645/318762077.py:3: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  ttc = pd.read_csv('../data/raw/ttc-bus-delay-data-2024.csv', parse_dates=['Date'])</code></pre>
</div>
</div>
<div id="38962e5b-02fe-4893-816e-d68aaab345d9" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ttc.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Time</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Direction</th>
<th data-quarto-table-cell-role="th">Vehicle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2024-01-01</td>
<td>89</td>
<td>02:08</td>
<td>Monday</td>
<td>KEELE AND GLENLAKE</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>N</td>
<td>7107</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2024-01-01</td>
<td>39</td>
<td>02:30</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>20</td>
<td>40</td>
<td>NaN</td>
<td>8914</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2024-01-01</td>
<td>300</td>
<td>03:13</td>
<td>Monday</td>
<td>BLOOR AND MANNING</td>
<td>General Delay</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8562</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2024-01-01</td>
<td>65</td>
<td>03:23</td>
<td>Monday</td>
<td>PARLIAMENT AND BLOOR</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>N</td>
<td>8574</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2024-01-01</td>
<td>113</td>
<td>03:37</td>
<td>Monday</td>
<td>MAIN STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8541</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="515d40df-a7ca-4617-aab5-aba3179f61dc" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .shape shows up how big our data is</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This dataset has </span><span class="sc">{</span>ttc<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> rows and </span><span class="sc">{</span>ttc<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ttc.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>This dataset has 45300 rows and 10 columns</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>(45300, 10)</code></pre>
</div>
</div>
<div id="f161f328-8fe8-4cf7-9d8e-2e37fe495940" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .info tells us about the object type for each column</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we can see 'Date' column was read as datetime object</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ttc.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 45300 entries, 0 to 45299
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype         
---  ------     --------------  -----         
 0   Date       45300 non-null  datetime64[ns]
 1   Route      44861 non-null  object        
 2   Time       45300 non-null  object        
 3   Day        45300 non-null  object        
 4   Location   45300 non-null  object        
 5   Incident   45300 non-null  object        
 6   Min Delay  45300 non-null  int64         
 7   Min Gap    45300 non-null  int64         
 8   Direction  38343 non-null  object        
 9   Vehicle    45300 non-null  int64         
dtypes: datetime64[ns](1), int64(3), object(6)
memory usage: 3.5+ MB</code></pre>
</div>
</div>
<div id="16c6cba1-847e-47fe-af9e-350c0b6661cb" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's also fix the 'Time' column</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ttc1 <span class="op">=</span> ttc.copy() <span class="co"># preserving the original</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting column to datetime object</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ttc1[<span class="st">'Time'</span>] <span class="op">=</span> pd.to_datetime(ttc[<span class="st">'Time'</span>]).dt.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m3/7mxrzzgs65x1zsl77zk_xn640000gn/T/ipykernel_5645/4215578345.py:5: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  ttc1['Time'] = pd.to_datetime(ttc['Time']).dt.time</code></pre>
</div>
</div>
<p>Now, let’s split ‘Date’ column into ‘Date_’ and ‘Month’ (year is not needed since this is for 2024), and convert ‘Time’ into ‘Hours’ so it more useful in the analysis later on.</p>
<div id="608f1aaa-630f-42c9-b5a8-51d73e2dfe6c" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ttc1[<span class="st">'Date_'</span>] <span class="op">=</span> ttc1[<span class="st">'Date'</span>].dt.date</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ttc1[<span class="st">'Month'</span>] <span class="op">=</span> ttc1[<span class="st">'Date'</span>].dt.month</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ttc1[<span class="st">'Hour'</span>] <span class="op">=</span> ttc1[<span class="st">'Time'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: x.hour) <span class="co"># used ChatGPT for this conversion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bb92cb6b-99d6-458d-9071-b5dc6d34e445" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's drop the 'Date' and 'Time' column since they are no longer needed</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ttc1 <span class="op">=</span> ttc1.drop(columns<span class="op">=</span>[<span class="st">'Date'</span>, <span class="st">'Time'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preprocessing-data" class="level3">
<h3 class="anchored" data-anchor-id="preprocessing-data">Preprocessing Data</h3>
<p>Now that the data is loaded in, we want to make sure we don’t perform our analysis will null values. So, we will go through and identify any columns that have big number of null values and determine if they are worth keeping for analysis or not.</p>
<div id="4a9e8100-3fc4-4d90-8050-33fcc44aef7d" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ttc1.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>Route         439
Day             0
Location        0
Incident        0
Min Delay       0
Min Gap         0
Direction    6957
Vehicle         0
Date_           0
Month           0
Hour            0
dtype: int64</code></pre>
</div>
</div>
<div id="d6961ddb-0e80-4a90-acaa-e0efa6a43459" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Direction' column has a lot null values. Let's see if these rows can be dropped</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ttc1[ttc1[<span class="st">'Direction'</span>].isna()].head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Direction</th>
<th data-quarto-table-cell-role="th">Vehicle</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>39</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>20</td>
<td>40</td>
<td>NaN</td>
<td>8914</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>300</td>
<td>Monday</td>
<td>BLOOR AND MANNING</td>
<td>General Delay</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8562</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>113</td>
<td>Monday</td>
<td>MAIN STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8541</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>600</td>
<td>Monday</td>
<td>LAKESHORE AND THIRTY S</td>
<td>Cleaning - Unsanitary</td>
<td>25</td>
<td>50</td>
<td>NaN</td>
<td>8798</td>
<td>2024-01-01</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>300</td>
<td>Monday</td>
<td>KIPLING STATION</td>
<td>Emergency Services</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>3330</td>
<td>2024-01-01</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>41</td>
<td>Monday</td>
<td>KEELE AND IAN MACDONAL</td>
<td>Diversion</td>
<td>780</td>
<td>793</td>
<td>NaN</td>
<td>7251</td>
<td>2024-01-01</td>
<td>1</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>85</td>
<td>Monday</td>
<td>TORONTO ZOO</td>
<td>Security</td>
<td>20</td>
<td>40</td>
<td>NaN</td>
<td>3495</td>
<td>2024-01-01</td>
<td>1</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>NaN</td>
<td>Monday</td>
<td>EGLINTON DIVISION</td>
<td>Operations - Operator</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>12</td>
<td>Monday</td>
<td>KENNEDY STATION</td>
<td>Emergency Services</td>
<td>30</td>
<td>60</td>
<td>NaN</td>
<td>8408</td>
<td>2024-01-01</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>900</td>
<td>Monday</td>
<td>KIPLING STATION</td>
<td>Operations - Operator</td>
<td>14</td>
<td>28</td>
<td>NaN</td>
<td>3341</td>
<td>2024-01-01</td>
<td>1</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>66</td>
<td>Monday</td>
<td>OLD MILL STATION</td>
<td>Mechanical</td>
<td>25</td>
<td>50</td>
<td>NaN</td>
<td>3329</td>
<td>2024-01-01</td>
<td>1</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38</td>
<td>87</td>
<td>Monday</td>
<td>EAST YORK ACRES</td>
<td>General Delay</td>
<td>52</td>
<td>62</td>
<td>NaN</td>
<td>8579</td>
<td>2024-01-01</td>
<td>1</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>96</td>
<td>Monday</td>
<td>HUMBERLINE LOOP</td>
<td>Security</td>
<td>10</td>
<td>20</td>
<td>NaN</td>
<td>3580</td>
<td>2024-01-01</td>
<td>1</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>60</td>
<td>Monday</td>
<td>PIONEER VILLAGE STATIO</td>
<td>Collision - TTC</td>
<td>10</td>
<td>20</td>
<td>NaN</td>
<td>8305</td>
<td>2024-01-01</td>
<td>1</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>106</td>
<td>Monday</td>
<td>SHEPPARD WEST STATION</td>
<td>Mechanical</td>
<td>12</td>
<td>24</td>
<td>NaN</td>
<td>8352</td>
<td>2024-01-01</td>
<td>1</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>61</td>
<td>Monday</td>
<td>AVENUE AND 401</td>
<td>Diversion</td>
<td>350</td>
<td>360</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>NaN</td>
<td>Monday</td>
<td>GUILDWOOD AND KINGSTON</td>
<td>Utilized Off Route</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8491</td>
<td>2024-01-01</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>165</td>
<td>Monday</td>
<td>WESTON AND LANYARD</td>
<td>Diversion</td>
<td>10</td>
<td>49</td>
<td>NaN</td>
<td>8920</td>
<td>2024-01-01</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>11</td>
<td>Monday</td>
<td>BAYVIEW AND STEELES</td>
<td>Security</td>
<td>24</td>
<td>48</td>
<td>NaN</td>
<td>8685</td>
<td>2024-01-01</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">104</td>
<td>300</td>
<td>Tuesday</td>
<td>KENNEDY STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8587</td>
<td>2024-01-02</td>
<td>1</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br> Maybe deleting the rows isn’t such a good idea because it makes up for a lot of overall data in the dataset. Instead, let’s drop the column since we already have information about the route. For that reason, it is also okay to drop ‘Vehicle’ column as it is not needed for our goal of observing delays in busses.</p>
<div id="ae89bf1d-d232-4e31-b44f-bd20de1711e6" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ttc_clean <span class="op">=</span> ttc1.drop(columns<span class="op">=</span>[<span class="st">'Direction'</span>, <span class="st">'Vehicle'</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ttc_clean.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>89</td>
<td>Monday</td>
<td>KEELE AND GLENLAKE</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>39</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>20</td>
<td>40</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>300</td>
<td>Monday</td>
<td>BLOOR AND MANNING</td>
<td>General Delay</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>65</td>
<td>Monday</td>
<td>PARLIAMENT AND BLOOR</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>113</td>
<td>Monday</td>
<td>MAIN STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now, let’s look at the Route column and its NaNs. This column is particularly important for us for our goal.</p>
<div id="cb41c4a3-a3a6-4cf2-93b3-8e0b47495c58" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>na_route <span class="op">=</span> ttc1[ttc1[<span class="st">'Route'</span>].isna()]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>na_route.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Direction</th>
<th data-quarto-table-cell-role="th">Vehicle</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>NaN</td>
<td>Monday</td>
<td>EGLINTON DIVISION</td>
<td>Operations - Operator</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">69</td>
<td>NaN</td>
<td>Monday</td>
<td>GUILDWOOD AND KINGSTON</td>
<td>Utilized Off Route</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8491</td>
<td>2024-01-01</td>
<td>1</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">213</td>
<td>NaN</td>
<td>Tuesday</td>
<td>QUEENSWAY GARAGE</td>
<td>Mechanical</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>8136</td>
<td>2024-01-02</td>
<td>1</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">248</td>
<td>NaN</td>
<td>Tuesday</td>
<td>3RD FLOOR GUNN BUILDIN</td>
<td>Operations - Operator</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-02</td>
<td>1</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">293</td>
<td>NaN</td>
<td>Wednesday</td>
<td>WILSON TRAINING OPERAT</td>
<td>Operations - Operator</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-03</td>
<td>1</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">350</td>
<td>NaN</td>
<td>Wednesday</td>
<td>RUSSELL CARHOUSE</td>
<td>Mechanical</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>349</td>
<td>2024-01-03</td>
<td>1</td>
<td>14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">602</td>
<td>NaN</td>
<td>Thursday</td>
<td>FINCH STATION</td>
<td>Operations - Operator</td>
<td>12</td>
<td>24</td>
<td>N</td>
<td>3253</td>
<td>2024-01-04</td>
<td>1</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">624</td>
<td>NaN</td>
<td>Thursday</td>
<td>ARROW GARAGE</td>
<td>Collision - TTC</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>1371</td>
<td>2024-01-04</td>
<td>1</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">638</td>
<td>NaN</td>
<td>Thursday</td>
<td>123 PARKWAY FOREST DRI</td>
<td>Utilized Off Route</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>3400</td>
<td>2024-01-04</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">659</td>
<td>NaN</td>
<td>Friday</td>
<td>MOUNT DENNIS DIVISION</td>
<td>Operations - Operator</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>2024-01-05</td>
<td>1</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="37a0c769-2318-4092-a251-3408bf3b8de2" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we will see how many for NaN routes have delays</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>na_route[na_route[<span class="st">'Min Delay'</span>] <span class="op">==</span> <span class="dv">0</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>Route          0
Day          363
Location     363
Incident     363
Min Delay    363
Min Gap      363
Direction     68
Vehicle      363
Date_        363
Month        363
Hour         363
dtype: int64</code></pre>
</div>
</div>
<p>Since all the NaN routes have 0 delays, it is safe to drop these rows. We will also remove all other null values to ensure a clean dataset to work with</p>
<div id="406ebf54-54d0-45fe-982c-dc1409b5bd8d" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ttc_clean <span class="op">=</span> ttc_clean.dropna()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ttc_clean.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>Route        0
Day          0
Location     0
Incident     0
Min Delay    0
Min Gap      0
Date_        0
Month        0
Hour         0
dtype: int64</code></pre>
</div>
</div>
<div id="cc8c41ae-7ee0-4190-b594-3511654b1b54" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ttc_clean.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>89</td>
<td>Monday</td>
<td>KEELE AND GLENLAKE</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>39</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>20</td>
<td>40</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>300</td>
<td>Monday</td>
<td>BLOOR AND MANNING</td>
<td>General Delay</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>65</td>
<td>Monday</td>
<td>PARLIAMENT AND BLOOR</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>113</td>
<td>Monday</td>
<td>MAIN STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="visualizing" class="level3">
<h3 class="anchored" data-anchor-id="visualizing">Visualizing</h3>
<p>Now it’s the fun part: visualizations!</p>
<p>Let’s look at how the delays are distributed in this data</p>
<div id="b5fb32f5-1fff-4928-b54e-012b70779a29" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ttc_filtered <span class="op">=</span> ttc_clean[ttc_clean[<span class="st">'Min Delay'</span>] <span class="op">&lt;</span> <span class="dv">200</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating histogram</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>delay_dist <span class="op">=</span> alt.Chart(ttc_filtered).mark_bar().encode(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Min Delay:Q'</span>, <span class="bu">bin</span><span class="op">=</span>alt.Bin(maxbins<span class="op">=</span><span class="dv">50</span>), title<span class="op">=</span><span class="st">'Delay (in minutes)'</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'count()'</span>, title<span class="op">=</span><span class="st">'Frequency'</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Distribution of Delays'</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>delay_dist.save(<span class="st">"delay_dist.png"</span>,ppi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>delay_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<style>
  #altair-viz-125d990c679f4c97938410c7bda0f48e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-125d990c679f4c97938410c7bda0f48e.vega-embed details,
  #altair-viz-125d990c679f4c97938410c7bda0f48e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-125d990c679f4c97938410c7bda0f48e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-125d990c679f4c97938410c7bda0f48e") {
      outputDiv = document.getElementById("altair-viz-125d990c679f4c97938410c7bda0f48e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0", "values": [{"__count": 13321, "bin_maxbins_50_Min Delay": 10.0, "bin_maxbins_50_Min Delay_end": 15.0}, {"__count": 6033, "bin_maxbins_50_Min Delay": 20.0, "bin_maxbins_50_Min Delay_end": 25.0}, {"__count": 5080, "bin_maxbins_50_Min Delay": 0.0, "bin_maxbins_50_Min Delay_end": 5.0}, {"__count": 8611, "bin_maxbins_50_Min Delay": 5.0, "bin_maxbins_50_Min Delay_end": 10.0}, {"__count": 2175, "bin_maxbins_50_Min Delay": 30.0, "bin_maxbins_50_Min Delay_end": 35.0}, {"__count": 1560, "bin_maxbins_50_Min Delay": 25.0, "bin_maxbins_50_Min Delay_end": 30.0}, {"__count": 5370, "bin_maxbins_50_Min Delay": 15.0, "bin_maxbins_50_Min Delay_end": 20.0}, {"__count": 125, "bin_maxbins_50_Min Delay": 55.0, "bin_maxbins_50_Min Delay_end": 60.0}, {"__count": 151, "bin_maxbins_50_Min Delay": 50.0, "bin_maxbins_50_Min Delay_end": 55.0}, {"__count": 140, "bin_maxbins_50_Min Delay": 45.0, "bin_maxbins_50_Min Delay_end": 50.0}, {"__count": 28, "bin_maxbins_50_Min Delay": 140.0, "bin_maxbins_50_Min Delay_end": 145.0}, {"__count": 64, "bin_maxbins_50_Min Delay": 90.0, "bin_maxbins_50_Min Delay_end": 95.0}, {"__count": 150, "bin_maxbins_50_Min Delay": 60.0, "bin_maxbins_50_Min Delay_end": 65.0}, {"__count": 54, "bin_maxbins_50_Min Delay": 75.0, "bin_maxbins_50_Min Delay_end": 80.0}, {"__count": 72, "bin_maxbins_50_Min Delay": 80.0, "bin_maxbins_50_Min Delay_end": 85.0}, {"__count": 203, "bin_maxbins_50_Min Delay": 35.0, "bin_maxbins_50_Min Delay_end": 40.0}, {"__count": 32, "bin_maxbins_50_Min Delay": 180.0, "bin_maxbins_50_Min Delay_end": 185.0}, {"__count": 50, "bin_maxbins_50_Min Delay": 115.0, "bin_maxbins_50_Min Delay_end": 120.0}, {"__count": 18, "bin_maxbins_50_Min Delay": 185.0, "bin_maxbins_50_Min Delay_end": 190.0}, {"__count": 63, "bin_maxbins_50_Min Delay": 100.0, "bin_maxbins_50_Min Delay_end": 105.0}, {"__count": 48, "bin_maxbins_50_Min Delay": 105.0, "bin_maxbins_50_Min Delay_end": 110.0}, {"__count": 202, "bin_maxbins_50_Min Delay": 40.0, "bin_maxbins_50_Min Delay_end": 45.0}, {"__count": 65, "bin_maxbins_50_Min Delay": 110.0, "bin_maxbins_50_Min Delay_end": 115.0}, {"__count": 46, "bin_maxbins_50_Min Delay": 95.0, "bin_maxbins_50_Min Delay_end": 100.0}, {"__count": 83, "bin_maxbins_50_Min Delay": 70.0, "bin_maxbins_50_Min Delay_end": 75.0}, {"__count": 20, "bin_maxbins_50_Min Delay": 190.0, "bin_maxbins_50_Min Delay_end": 195.0}, {"__count": 51, "bin_maxbins_50_Min Delay": 120.0, "bin_maxbins_50_Min Delay_end": 125.0}, {"__count": 21, "bin_maxbins_50_Min Delay": 145.0, "bin_maxbins_50_Min Delay_end": 150.0}, {"__count": 60, "bin_maxbins_50_Min Delay": 85.0, "bin_maxbins_50_Min Delay_end": 90.0}, {"__count": 92, "bin_maxbins_50_Min Delay": 65.0, "bin_maxbins_50_Min Delay_end": 70.0}, {"__count": 34, "bin_maxbins_50_Min Delay": 130.0, "bin_maxbins_50_Min Delay_end": 135.0}, {"__count": 25, "bin_maxbins_50_Min Delay": 175.0, "bin_maxbins_50_Min Delay_end": 180.0}, {"__count": 15, "bin_maxbins_50_Min Delay": 160.0, "bin_maxbins_50_Min Delay_end": 165.0}, {"__count": 22, "bin_maxbins_50_Min Delay": 135.0, "bin_maxbins_50_Min Delay_end": 140.0}, {"__count": 27, "bin_maxbins_50_Min Delay": 150.0, "bin_maxbins_50_Min Delay_end": 155.0}, {"__count": 14, "bin_maxbins_50_Min Delay": 155.0, "bin_maxbins_50_Min Delay_end": 160.0}, {"__count": 15, "bin_maxbins_50_Min Delay": 195.0, "bin_maxbins_50_Min Delay_end": 200.0}, {"__count": 29, "bin_maxbins_50_Min Delay": 125.0, "bin_maxbins_50_Min Delay_end": 130.0}, {"__count": 19, "bin_maxbins_50_Min Delay": 165.0, "bin_maxbins_50_Min Delay_end": 170.0}, {"__count": 21, "bin_maxbins_50_Min Delay": 170.0, "bin_maxbins_50_Min Delay_end": 175.0}]}, {"name": "source_0_y_domain___count", "values": [{"min": 14, "max": 13321}]}], "signals": [{"name": "bin_maxbins_50_Min_Delay_bins", "value": {"fields": ["Min Delay"], "fname": "bin_Min Delay", "start": 0.0, "step": 5.0, "stop": 200.0}}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "source_0"}, "encode": {"update": {"y": {"field": "__count", "scale": "y"}, "x2": {"field": "bin_maxbins_50_Min Delay", "scale": "x", "offset": {"signal": "0.5 + (abs(scale(\"x\", datum[\"bin_maxbins_50_Min Delay_end\"]) - scale(\"x\", datum[\"bin_maxbins_50_Min Delay\"])) < 0.25 ? -0.5 * (0.25 - (abs(scale(\"x\", datum[\"bin_maxbins_50_Min Delay_end\"]) - scale(\"x\", datum[\"bin_maxbins_50_Min Delay\"])))) : 0.5)"}}, "fill": {"value": "#4c78a8"}, "x": {"field": "bin_maxbins_50_Min Delay_end", "scale": "x", "offset": {"signal": "0.5 + (abs(scale(\"x\", datum[\"bin_maxbins_50_Min Delay_end\"]) - scale(\"x\", datum[\"bin_maxbins_50_Min Delay\"])) < 0.25 ? 0.5 * (0.25 - (abs(scale(\"x\", datum[\"bin_maxbins_50_Min Delay_end\"]) - scale(\"x\", datum[\"bin_maxbins_50_Min Delay\"])))) : -0.5)"}}, "y2": {"value": 0, "scale": "y"}}}, "style": ["bar"]}], "scales": [{"name": "x", "type": "linear", "domain": {"signal": "[bin_maxbins_50_Min_Delay_bins.start, bin_maxbins_50_Min_Delay_bins.stop]"}, "range": [0, {"signal": "width"}], "bins": {"signal": "bin_maxbins_50_Min_Delay_bins"}, "zero": false}, {"name": "y", "type": "linear", "domain": [{"signal": "(data(\"source_0_y_domain___count\")[0] || {}).min"}, {"signal": "(data(\"source_0_y_domain___count\")[0] || {}).max"}], "range": [{"signal": "height"}, 0], "zero": true, "nice": true}], "axes": [{"scale": "y", "domain": false, "aria": false, "orient": "left", "grid": true, "gridScale": "x", "tickCount": {"signal": "ceil(height/40)"}, "labels": false, "maxExtent": 0, "minExtent": 0, "ticks": false, "zindex": 0}, {"scale": "x", "grid": false, "labelFlush": true, "labelOverlap": true, "tickCount": {"signal": "ceil(width/10)"}, "zindex": 0, "orient": "bottom", "title": "Delay (in minutes)"}, {"scale": "y", "labelOverlap": true, "tickCount": {"signal": "ceil(height/40)"}, "title": "Frequency", "orient": "left", "zindex": 0, "grid": false}], "title": {"text": "Distribution of Delays", "frame": "group"}, "padding": 5, "width": 300, "style": "cell", "height": 300, "background": "white"}, {"mode": "vega"});
</script>
</div>
</div>
<p>This plot shows that majority of the delays occur within 0 to 25 mins. This can indicate that most delays are short in duration.</p>
<hr>
<p>Now let’s take a look at top 20 routes with highest delay incidents</p>
<div id="fc5210d8-1bd9-4e9f-a755-67c9680e5555" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'Route' and count the occurrences</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>route_counts <span class="op">=</span> ttc_clean.groupby(<span class="st">'Route'</span>).size().reset_index(name<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort counts in descending order and get the top 20 routes</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>route_counts <span class="op">=</span> route_counts.sort_values(<span class="st">'Count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>top_routes <span class="op">=</span> route_counts.head(<span class="dv">20</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#top_routes</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating bar chart</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>top20_delay_routes <span class="op">=</span> alt.Chart(top_routes).mark_bar().encode(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Route:N'</span>, title<span class="op">=</span><span class="st">'Route'</span>, sort<span class="op">=</span>alt.EncodingSortField(field<span class="op">=</span><span class="st">'Count'</span>, order<span class="op">=</span><span class="st">'descending'</span>)),  <span class="co"># 'N' for nominal (categorical)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Count:Q'</span>, title<span class="op">=</span><span class="st">'Count'</span>),  <span class="co"># 'Q' for quantitative (numerical)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Count:Q'</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Top 20 Routes with Highest Delay Incidents'</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>top20_delay_routes.save(<span class="st">"top20_delay_routes.png"</span>,ppi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>top20_delay_routes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<style>
  #altair-viz-f4b01710506d4262827ea65ed4add623.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f4b01710506d4262827ea65ed4add623.vega-embed details,
  #altair-viz-f4b01710506d4262827ea65ed4add623.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f4b01710506d4262827ea65ed4add623"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f4b01710506d4262827ea65ed4add623") {
      outputDiv = document.getElementById("altair-viz-f4b01710506d4262827ea65ed4add623");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0"}, {"name": "data_0", "values": [{"Count": 1387, "Count_end": 1387.0, "Count_start": 0.0, "Route": "32"}, {"Count": 1309, "Count_end": 1309.0, "Count_start": 0.0, "Route": "52"}, {"Count": 1234, "Count_end": 1234.0, "Count_start": 0.0, "Route": "36"}, {"Count": 1072, "Count_end": 1072.0, "Count_start": 0.0, "Route": "35"}, {"Count": 1046, "Count_end": 1046.0, "Count_start": 0.0, "Route": "29"}, {"Count": 982, "Count_end": 982.0, "Count_start": 0.0, "Route": "63"}, {"Count": 777, "Count_end": 777.0, "Count_start": 0.0, "Route": "95"}, {"Count": 771, "Count_end": 771.0, "Count_start": 0.0, "Route": "85"}, {"Count": 746, "Count_end": 746.0, "Count_start": 0.0, "Route": "102"}, {"Count": 744, "Count_end": 744.0, "Count_start": 0.0, "Route": "54"}, {"Count": 743, "Count_end": 743.0, "Count_start": 0.0, "Route": "96"}, {"Count": 736, "Count_end": 736.0, "Count_start": 0.0, "Route": "7"}, {"Count": 677, "Count_end": 677.0, "Count_start": 0.0, "Route": "41"}, {"Count": 661, "Count_end": 661.0, "Count_start": 0.0, "Route": "116"}, {"Count": 647, "Count_end": 647.0, "Count_start": 0.0, "Route": "43"}, {"Count": 644, "Count_end": 644.0, "Count_start": 0.0, "Route": "929"}, {"Count": 610, "Count_end": 610.0, "Count_start": 0.0, "Route": "47"}, {"Count": 607, "Count_end": 607.0, "Count_start": 0.0, "Route": "939"}, {"Count": 584, "Count_end": 584.0, "Count_start": 0.0, "Route": "53"}, {"Count": 578, "Count_end": 578.0, "Count_start": 0.0, "Route": "165"}]}, {"name": "source_0_x_domain_Route", "values": [{"Route": "32", "sort_field": 1387}, {"Route": "52", "sort_field": 1309}, {"Route": "36", "sort_field": 1234}, {"Route": "35", "sort_field": 1072}, {"Route": "29", "sort_field": 1046}, {"Route": "63", "sort_field": 982}, {"Route": "95", "sort_field": 777}, {"Route": "85", "sort_field": 771}, {"Route": "102", "sort_field": 746}, {"Route": "54", "sort_field": 744}, {"Route": "96", "sort_field": 743}, {"Route": "7", "sort_field": 736}, {"Route": "41", "sort_field": 677}, {"Route": "116", "sort_field": 661}, {"Route": "43", "sort_field": 647}, {"Route": "929", "sort_field": 644}, {"Route": "47", "sort_field": 610}, {"Route": "939", "sort_field": 607}, {"Route": "53", "sort_field": 584}, {"Route": "165", "sort_field": 578}]}, {"name": "data_0_color_domain_Count", "values": [{"min": 578, "max": 1387}]}], "signals": [{"name": "x_step", "value": 20}, {"name": "width", "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "data_0"}, "encode": {"update": {"fill": {"field": "Count", "scale": "color"}, "width": {"signal": "max(0.25, bandwidth('x'))"}, "x": {"field": "Route", "scale": "x"}, "y2": {"field": "Count_start", "scale": "y"}, "y": {"field": "Count_end", "scale": "y"}}}, "style": ["bar"]}], "scales": [{"name": "x", "type": "band", "domain": {"data": "source_0_x_domain_Route", "field": "Route", "sort": {"op": "max", "field": "sort_field", "order": "descending"}}, "range": {"step": {"signal": "x_step"}}, "paddingOuter": 0.05, "paddingInner": 0.1}, {"name": "y", "type": "linear", "domain": {"data": "data_0", "fields": ["Count_start", "Count_end"]}, "range": [{"signal": "height"}, 0], "nice": true, "zero": true}, {"name": "color", "type": "linear", "domain": [{"signal": "(data(\"data_0_color_domain_Count\")[0] || {}).min"}, {"signal": "(data(\"data_0_color_domain_Count\")[0] || {}).max"}], "range": "ramp", "interpolate": "hcl", "zero": false}], "axes": [{"scale": "y", "grid": true, "orient": "left", "minExtent": 0, "tickCount": {"signal": "ceil(height/40)"}, "zindex": 0, "aria": false, "gridScale": "x", "domain": false, "maxExtent": 0, "labels": false, "ticks": false}, {"scale": "x", "orient": "bottom", "zindex": 0, "labelBaseline": "middle", "title": "Route", "grid": false, "labelAlign": "right", "labelAngle": 270}, {"scale": "y", "tickCount": {"signal": "ceil(height/40)"}, "title": "Count", "labelOverlap": true, "grid": false, "orient": "left", "zindex": 0}], "title": {"text": "Top 20 Routes with Highest Delay Incidents", "frame": "group"}, "style": "cell", "legends": [{"fill": "color", "gradientLength": {"signal": "clamp(height, 64, 200)"}, "title": "Count"}], "padding": 5, "background": "white", "height": 300}, {"mode": "vega"});
</script>
</div>
</div>
<p>This plot shows that majority of the incidents are occuring on route 32 with close to 1,400 counts of delays, followed by route 32 and 36. As we move towards other routes, there seems to be a smooth decline in delay counts, showing a decreasing trend.</p>
<div id="ae2818a6-28c8-407c-9f86-1d8272731283" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 locations with Highest Delay Counts</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where 'Min Delay' is greater than 0 (i.e., there is an actual delay)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>delayed_ttc <span class="op">=</span> ttc[ttc[<span class="st">'Min Delay'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'Location' and count the number of delays (i.e., count occurrences where 'Min Delay' &gt; 0)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>delay_counts <span class="op">=</span> delayed_ttc.groupby(<span class="st">'Location'</span>)[<span class="st">'Min Delay'</span>].count().reset_index()</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the column for clarity</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>delay_counts <span class="op">=</span> delay_counts.rename(columns<span class="op">=</span>{<span class="st">'Min Delay'</span>: <span class="st">'Delay Count'</span>})</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by 'Delay Count' in descending order</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>delay_counts_sorted <span class="op">=</span> delay_counts.sort_values(by<span class="op">=</span><span class="st">'Delay Count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the top 10 locations with the highest delay counts</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>top_10_locations <span class="op">=</span> delay_counts_sorted.head(<span class="dv">10</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the top 10 locations with the highest delay counts</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_10_locations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Location  Delay Count
3675         KENNEDY STATION         1263
3955         KIPLING STATION          820
2326        EGLINTON STATION          688
7713          WILSON STATION          628
2734           FINCH STATION          623
5544  PIONEER VILLAGE STATIO          575
5986  SCARBOROUGH CENTRE STA          431
7365          WARDEN STATION          419
8026      YORK MILLS STATION          377
1688       DON MILLS STATION          371</code></pre>
</div>
</div>
<div id="870e4a5e-9583-4a48-b832-65bcd17c06be" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart of the top 10 locations with the highest delay counts</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> alt.Chart(top_10_locations).mark_bar().encode(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>alt.X(<span class="st">'Delay Count:Q'</span>, title<span class="op">=</span><span class="st">'Delay Count'</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'Location:N'</span>, title<span class="op">=</span><span class="st">'Location'</span>, sort<span class="op">=</span><span class="st">'-x'</span>),  <span class="co"># Sort by delay count (descending)</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Location:N'</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Top 10 Locations with the Highest Delay Counts'</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>chart.save(<span class="st">"top10_locations.png"</span>,ppi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>chart.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-e292eb92dd254402ad0f666f9d73236b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-e292eb92dd254402ad0f666f9d73236b.vega-embed details,
  #altair-viz-e292eb92dd254402ad0f666f9d73236b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-e292eb92dd254402ad0f666f9d73236b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-e292eb92dd254402ad0f666f9d73236b") {
      outputDiv = document.getElementById("altair-viz-e292eb92dd254402ad0f666f9d73236b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0"}, {"name": "data_0", "values": [{"Delay Count_end": 1263.0, "Delay Count_start": 0.0, "Location": "KENNEDY STATION"}, {"Delay Count_end": 820.0, "Delay Count_start": 0.0, "Location": "KIPLING STATION"}, {"Delay Count_end": 688.0, "Delay Count_start": 0.0, "Location": "EGLINTON STATION"}, {"Delay Count_end": 628.0, "Delay Count_start": 0.0, "Location": "WILSON STATION"}, {"Delay Count_end": 623.0, "Delay Count_start": 0.0, "Location": "FINCH STATION"}, {"Delay Count_end": 575.0, "Delay Count_start": 0.0, "Location": "PIONEER VILLAGE STATIO"}, {"Delay Count_end": 431.0, "Delay Count_start": 0.0, "Location": "SCARBOROUGH CENTRE STA"}, {"Delay Count_end": 419.0, "Delay Count_start": 0.0, "Location": "WARDEN STATION"}, {"Delay Count_end": 377.0, "Delay Count_start": 0.0, "Location": "YORK MILLS STATION"}, {"Delay Count_end": 371.0, "Delay Count_start": 0.0, "Location": "DON MILLS STATION"}]}, {"name": "source_0_y_domain_Location", "values": [{"Location": "KENNEDY STATION", "sort_field": 1263}, {"Location": "KIPLING STATION", "sort_field": 820}, {"Location": "EGLINTON STATION", "sort_field": 688}, {"Location": "WILSON STATION", "sort_field": 628}, {"Location": "FINCH STATION", "sort_field": 623}, {"Location": "PIONEER VILLAGE STATIO", "sort_field": 575}, {"Location": "SCARBOROUGH CENTRE STA", "sort_field": 431}, {"Location": "WARDEN STATION", "sort_field": 419}, {"Location": "YORK MILLS STATION", "sort_field": 377}, {"Location": "DON MILLS STATION", "sort_field": 371}]}, {"name": "data_0_color_domain_Location", "values": [{"Location": "KENNEDY STATION"}, {"Location": "KIPLING STATION"}, {"Location": "EGLINTON STATION"}, {"Location": "WILSON STATION"}, {"Location": "FINCH STATION"}, {"Location": "PIONEER VILLAGE STATIO"}, {"Location": "SCARBOROUGH CENTRE STA"}, {"Location": "WARDEN STATION"}, {"Location": "YORK MILLS STATION"}, {"Location": "DON MILLS STATION"}]}], "signals": [{"name": "y_step", "value": 20}, {"name": "height", "update": "bandspace(domain('y').length, 0.1, 0.05) * y_step"}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "data_0"}, "encode": {"update": {"fill": {"field": "Location", "scale": "color"}, "y": {"field": "Location", "scale": "y"}, "x": {"field": "Delay Count_end", "scale": "x"}, "height": {"signal": "max(0.25, bandwidth('y'))"}, "x2": {"field": "Delay Count_start", "scale": "x"}}}, "style": ["bar"]}], "scales": [{"name": "x", "type": "linear", "domain": {"data": "data_0", "fields": ["Delay Count_start", "Delay Count_end"]}, "range": [0, {"signal": "width"}], "zero": true, "nice": true}, {"name": "y", "type": "band", "domain": {"data": "source_0_y_domain_Location", "field": "Location", "sort": {"op": "max", "field": "sort_field", "order": "descending"}}, "range": {"step": {"signal": "y_step"}}, "paddingInner": 0.1, "paddingOuter": 0.05}, {"name": "color", "type": "ordinal", "domain": {"data": "data_0_color_domain_Location", "field": "Location", "sort": true}, "range": "category"}], "axes": [{"scale": "x", "tickCount": {"signal": "ceil(width/40)"}, "domain": false, "aria": false, "ticks": false, "minExtent": 0, "gridScale": "y", "orient": "bottom", "zindex": 0, "labels": false, "maxExtent": 0, "grid": true}, {"scale": "x", "grid": false, "title": "Delay Count", "orient": "bottom", "labelFlush": true, "labelOverlap": true, "tickCount": {"signal": "ceil(width/40)"}, "zindex": 0}, {"scale": "y", "grid": false, "zindex": 0, "title": "Location", "orient": "left"}], "title": {"text": "Top 10 Locations with the Highest Delay Counts", "frame": "group"}, "style": "cell", "width": 300, "background": "white", "legends": [{"fill": "color", "symbolType": "square", "title": "Location"}], "padding": 5}, {"mode": "vega"});
</script>
</div>
</div>
<div id="089441bd-520f-470d-8f5a-2f696bc249d0" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delay Counts by Day of the Week</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>delay_counts_day <span class="op">=</span> delayed_ttc.groupby(<span class="st">'Day'</span>)[<span class="st">'Min Delay'</span>].count().reset_index()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>delay_counts_day <span class="op">=</span> delay_counts_day.rename(columns<span class="op">=</span>{<span class="st">'Min Delay'</span>: <span class="st">'Delay Count'</span>})</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>delay_counts_day <span class="op">=</span> delay_counts_day.sort_values(by<span class="op">=</span><span class="st">'Delay Count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Delay Counts by Day of the Week"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(delay_counts_day)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot delay counts by Day of the Week</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>chart_month <span class="op">=</span> alt.Chart(delay_counts_day).mark_bar().encode(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>alt.X(<span class="st">'Day:O'</span>, title<span class="op">=</span><span class="st">'Day of the Week'</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'Delay Count:Q'</span>, title<span class="op">=</span><span class="st">'Delay Count'</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Day:O'</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Delay Counts by Day of the Week'</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>chart_month.save(<span class="st">"chart_month.png"</span>,ppi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>chart_month.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Delay Counts by Day of the Week
         Day  Delay Count
0     Friday         6541
5    Tuesday         6198
4   Thursday         6189
6  Wednesday         6038
2   Saturday         5662
1     Monday         5441
3     Sunday         4149</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-b1867a0f583743a7b206d5c159352f5c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b1867a0f583743a7b206d5c159352f5c.vega-embed details,
  #altair-viz-b1867a0f583743a7b206d5c159352f5c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b1867a0f583743a7b206d5c159352f5c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b1867a0f583743a7b206d5c159352f5c") {
      outputDiv = document.getElementById("altair-viz-b1867a0f583743a7b206d5c159352f5c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0", "values": [{"Day": "Friday", "Delay Count_end": 6541.0, "Delay Count_start": 0.0}, {"Day": "Tuesday", "Delay Count_end": 6198.0, "Delay Count_start": 0.0}, {"Day": "Thursday", "Delay Count_end": 6189.0, "Delay Count_start": 0.0}, {"Day": "Wednesday", "Delay Count_end": 6038.0, "Delay Count_start": 0.0}, {"Day": "Saturday", "Delay Count_end": 5662.0, "Delay Count_start": 0.0}, {"Day": "Monday", "Delay Count_end": 5441.0, "Delay Count_start": 0.0}, {"Day": "Sunday", "Delay Count_end": 4149.0, "Delay Count_start": 0.0}]}, {"name": "source_0_x_domain_Day", "values": [{"Day": "Friday"}, {"Day": "Tuesday"}, {"Day": "Thursday"}, {"Day": "Wednesday"}, {"Day": "Saturday"}, {"Day": "Monday"}, {"Day": "Sunday"}]}, {"name": "source_0_color_domain_Day", "values": [{"Day": "Friday"}, {"Day": "Tuesday"}, {"Day": "Thursday"}, {"Day": "Wednesday"}, {"Day": "Saturday"}, {"Day": "Monday"}, {"Day": "Sunday"}]}], "signals": [{"name": "x_step", "value": 20}, {"name": "width", "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "source_0"}, "encode": {"update": {"width": {"signal": "max(0.25, bandwidth('x'))"}, "fill": {"field": "Day", "scale": "color"}, "x": {"field": "Day", "scale": "x"}, "y": {"field": "Delay Count_end", "scale": "y"}, "y2": {"field": "Delay Count_start", "scale": "y"}}}, "style": ["bar"]}], "scales": [{"name": "x", "type": "band", "domain": {"data": "source_0_x_domain_Day", "field": "Day", "sort": true}, "range": {"step": {"signal": "x_step"}}, "paddingInner": 0.1, "paddingOuter": 0.05}, {"name": "y", "type": "linear", "domain": {"data": "source_0", "fields": ["Delay Count_start", "Delay Count_end"]}, "range": [{"signal": "height"}, 0], "nice": true, "zero": true}, {"name": "color", "type": "ordinal", "domain": {"data": "source_0_color_domain_Day", "field": "Day", "sort": true}, "range": "ordinal", "interpolate": "hcl"}], "axes": [{"scale": "y", "domain": false, "minExtent": 0, "zindex": 0, "aria": false, "labels": false, "gridScale": "x", "maxExtent": 0, "ticks": false, "orient": "left", "tickCount": {"signal": "ceil(height/40)"}, "grid": true}, {"scale": "x", "labelAngle": 270, "grid": false, "orient": "bottom", "labelAlign": "right", "labelBaseline": "middle", "title": "Day of the Week", "zindex": 0}, {"scale": "y", "tickCount": {"signal": "ceil(height/40)"}, "zindex": 0, "title": "Delay Count", "orient": "left", "labelOverlap": true, "grid": false}], "title": {"text": "Delay Counts by Day of the Week", "frame": "group"}, "height": 300, "background": "white", "legends": [{"fill": "color", "symbolType": "square", "title": "Day"}], "style": "cell", "padding": 5}, {"mode": "vega"});
</script>
</div>
</div>
<div id="1457379e-9e58-4708-9e2e-8f86dabe5d53" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>delay_counts_incident <span class="op">=</span> delayed_ttc.groupby(<span class="st">'Incident'</span>)[<span class="st">'Min Delay'</span>].count().reset_index()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>delay_counts_incident <span class="op">=</span> delay_counts_incident.rename(columns<span class="op">=</span>{<span class="st">'Min Delay'</span>: <span class="st">'Delay Count'</span>})</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>delay_counts_incident <span class="op">=</span> delay_counts_incident.sort_values(by<span class="op">=</span><span class="st">'Delay Count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Delay Counts by Incident Type"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(delay_counts_incident)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize delay counts by Incident Type</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>chart_incident <span class="op">=</span> alt.Chart(delay_counts_incident).mark_bar().encode(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>alt.X(<span class="st">'Incident:N'</span>, title<span class="op">=</span><span class="st">'Incident Type'</span>, sort<span class="op">=</span><span class="st">'-y'</span>),  <span class="co"># Sort by Delay Count</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'Delay Count:Q'</span>, title<span class="op">=</span><span class="st">'Delay Count'</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Incident:N'</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Delay Counts by Incident Type'</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>chart_incident.save(<span class="st">"chart_incident.png"</span>,ppi<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>chart_incident.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Delay Counts by Incident Type
                            Incident  Delay Count
6                         Mechanical        14846
7              Operations - Operator         7483
2                          Diversion         3125
9                           Security         2838
1                    Collision - TTC         2772
3                 Emergency Services         1978
10                Utilized Off Route         1953
0              Cleaning - Unsanitary         1764
11                            Vision         1372
4                      General Delay         1192
5                      Investigation          772
8   Road Blocked - NON-TTC Collision          123</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
  #altair-viz-0b37aa030c3e40c497e19e212a1b8c2d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0b37aa030c3e40c497e19e212a1b8c2d.vega-embed details,
  #altair-viz-0b37aa030c3e40c497e19e212a1b8c2d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0b37aa030c3e40c497e19e212a1b8c2d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0b37aa030c3e40c497e19e212a1b8c2d") {
      outputDiv = document.getElementById("altair-viz-0b37aa030c3e40c497e19e212a1b8c2d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0"}, {"name": "data_0", "values": [{"Delay Count_end": 14846.0, "Delay Count_start": 0.0, "Incident": "Mechanical"}, {"Delay Count_end": 7483.0, "Delay Count_start": 0.0, "Incident": "Operations - Operator"}, {"Delay Count_end": 3125.0, "Delay Count_start": 0.0, "Incident": "Diversion"}, {"Delay Count_end": 2838.0, "Delay Count_start": 0.0, "Incident": "Security"}, {"Delay Count_end": 2772.0, "Delay Count_start": 0.0, "Incident": "Collision - TTC"}, {"Delay Count_end": 1978.0, "Delay Count_start": 0.0, "Incident": "Emergency Services"}, {"Delay Count_end": 1953.0, "Delay Count_start": 0.0, "Incident": "Utilized Off Route"}, {"Delay Count_end": 1764.0, "Delay Count_start": 0.0, "Incident": "Cleaning - Unsanitary"}, {"Delay Count_end": 1372.0, "Delay Count_start": 0.0, "Incident": "Vision"}, {"Delay Count_end": 1192.0, "Delay Count_start": 0.0, "Incident": "General Delay"}, {"Delay Count_end": 772.0, "Delay Count_start": 0.0, "Incident": "Investigation"}, {"Delay Count_end": 123.0, "Delay Count_start": 0.0, "Incident": "Road Blocked - NON-TTC Collision"}]}, {"name": "source_0_x_domain_Incident", "values": [{"Incident": "Mechanical", "sort_field": 14846}, {"Incident": "Operations - Operator", "sort_field": 7483}, {"Incident": "Diversion", "sort_field": 3125}, {"Incident": "Security", "sort_field": 2838}, {"Incident": "Collision - TTC", "sort_field": 2772}, {"Incident": "Emergency Services", "sort_field": 1978}, {"Incident": "Utilized Off Route", "sort_field": 1953}, {"Incident": "Cleaning - Unsanitary", "sort_field": 1764}, {"Incident": "Vision", "sort_field": 1372}, {"Incident": "General Delay", "sort_field": 1192}, {"Incident": "Investigation", "sort_field": 772}, {"Incident": "Road Blocked - NON-TTC Collision", "sort_field": 123}]}, {"name": "data_0_color_domain_Incident", "values": [{"Incident": "Mechanical"}, {"Incident": "Operations - Operator"}, {"Incident": "Diversion"}, {"Incident": "Security"}, {"Incident": "Collision - TTC"}, {"Incident": "Emergency Services"}, {"Incident": "Utilized Off Route"}, {"Incident": "Cleaning - Unsanitary"}, {"Incident": "Vision"}, {"Incident": "General Delay"}, {"Incident": "Investigation"}, {"Incident": "Road Blocked - NON-TTC Collision"}]}], "signals": [{"name": "x_step", "value": 20}, {"name": "width", "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "data_0"}, "encode": {"update": {"x": {"field": "Incident", "scale": "x"}, "width": {"signal": "max(0.25, bandwidth('x'))"}, "y": {"field": "Delay Count_end", "scale": "y"}, "y2": {"field": "Delay Count_start", "scale": "y"}, "fill": {"field": "Incident", "scale": "color"}}}, "style": ["bar"]}], "scales": [{"name": "x", "type": "band", "domain": {"data": "source_0_x_domain_Incident", "field": "Incident", "sort": {"op": "max", "field": "sort_field", "order": "descending"}}, "range": {"step": {"signal": "x_step"}}, "paddingOuter": 0.05, "paddingInner": 0.1}, {"name": "y", "type": "linear", "domain": {"data": "data_0", "fields": ["Delay Count_start", "Delay Count_end"]}, "range": [{"signal": "height"}, 0], "zero": true, "nice": true}, {"name": "color", "type": "ordinal", "domain": {"data": "data_0_color_domain_Incident", "field": "Incident", "sort": true}, "range": "category"}], "axes": [{"scale": "y", "grid": true, "gridScale": "x", "maxExtent": 0, "minExtent": 0, "orient": "left", "zindex": 0, "labels": false, "ticks": false, "aria": false, "tickCount": {"signal": "ceil(height/40)"}, "domain": false}, {"scale": "x", "title": "Incident Type", "labelBaseline": "middle", "labelAngle": 270, "zindex": 0, "labelAlign": "right", "orient": "bottom", "grid": false}, {"scale": "y", "tickCount": {"signal": "ceil(height/40)"}, "zindex": 0, "title": "Delay Count", "labelOverlap": true, "orient": "left", "grid": false}], "title": {"text": "Delay Counts by Incident Type", "frame": "group"}, "legends": [{"fill": "color", "symbolType": "square", "title": "Incident"}], "padding": 5, "background": "white", "height": 300, "style": "cell"}, {"mode": "vega"});
</script>
</div>
</div>
</section>
</section>
<section id="linear-regression-model-for-prediction" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-model-for-prediction">Linear Regression Model for Prediction</h2>
<p>The EDA analysis was very informative in understanding the columns of interest for this project. The columns which seem to impact the Min Delay are Incident and Route, so this analysis will be focused around using these 2 columns to create a Logistic Regression model, to predict the expected delay given a route and incident. The delay output will be categorized into “Short”, “Medium” or “Long”. Cross-validation and randomized grid search were applied for hyperparameter tuning to enhance model performance.</p>
<p>First the required libraries are loaded to perrform the analysis.</p>
<div id="081981d7-21cd-4b93-b63b-ee9a5d1863bc" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.dummy <span class="im">import</span> DummyClassifier</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_validate, RandomizedSearchCV</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To perform the analysis, the cleaned data from the EDA will be used.</p>
<div id="cccfad3d-541a-46af-8d75-320c89724252" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ttc_clean.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ttc_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>89</td>
<td>Monday</td>
<td>KEELE AND GLENLAKE</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>39</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>20</td>
<td>40</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>300</td>
<td>Monday</td>
<td>BLOOR AND MANNING</td>
<td>General Delay</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>65</td>
<td>Monday</td>
<td>PARLIAMENT AND BLOOR</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>113</td>
<td>Monday</td>
<td>MAIN STATION</td>
<td>Security</td>
<td>0</td>
<td>0</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44856</td>
<td>63</td>
<td>Monday</td>
<td>KING AND DOWLING</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44857</td>
<td>32</td>
<td>Monday</td>
<td>EGLINTON AND OAKWOOD</td>
<td>Vision</td>
<td>13</td>
<td>18</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44858</td>
<td>63</td>
<td>Monday</td>
<td>OSSINGTON STATION</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44859</td>
<td>31</td>
<td>Monday</td>
<td>COXWELL STATION</td>
<td>Emergency Services</td>
<td>17</td>
<td>34</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44860</td>
<td>54</td>
<td>Monday</td>
<td>ROGUE HILL GO STATION</td>
<td>Vision</td>
<td>10</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>44861 rows × 9 columns</p>
</div>
</div>
</div>
<p>Seeing as the data has alot of extreme values, the outliers will be eliminated. These outliers are delays greater than 30 minutes and less than 1 minute.</p>
<div id="5fdf440b-11b3-46e8-b83c-f09707e8c472" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ttc_lr <span class="op">=</span> ttc_clean.loc[(ttc_clean[<span class="st">"Min Delay"</span>]<span class="op">&lt;</span><span class="dv">30</span>) <span class="op">&amp;</span> (ttc_clean[<span class="st">"Min Delay"</span>]<span class="op">&gt;</span><span class="dv">0</span>)].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, the <code>Min Delay</code> column needs to be pre processed as there are multiple unique values and predicting on such values is not efficient, thus the times are divided in 3 classes: * Short Delay: delays less than or equal to 10 minutes * Medium Delay: Delays of more than 10 minutes but less than or equal to 20 minutes * Long Delays: Delays greater than 20 minutes</p>
<div id="f0aefe02-b847-4aed-9881-4157c429915b" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ttc_lr[<span class="st">"Min Delay"</span>] <span class="op">=</span> ttc_lr[<span class="st">"Min Delay"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">"Short Delay"</span> <span class="cf">if</span> <span class="bu">type</span>(x)<span class="op">==</span> <span class="bu">int</span> <span class="kw">and</span> x <span class="op">&gt;</span><span class="dv">0</span> <span class="kw">and</span> x<span class="op">&lt;=</span><span class="dv">10</span> <span class="cf">else</span> x)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ttc_lr[<span class="st">"Min Delay"</span>] <span class="op">=</span> ttc_lr[<span class="st">"Min Delay"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">"Medium Delay"</span> <span class="cf">if</span> <span class="bu">type</span>(x)<span class="op">==</span> <span class="bu">int</span> <span class="kw">and</span>  x <span class="op">&gt;</span><span class="dv">10</span> <span class="kw">and</span> x<span class="op">&lt;=</span><span class="dv">20</span> <span class="cf">else</span> x)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ttc_lr[<span class="st">"Min Delay"</span>] <span class="op">=</span> ttc_lr[<span class="st">"Min Delay"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">"Long Delay"</span> <span class="cf">if</span> <span class="bu">type</span>(x)<span class="op">==</span> <span class="bu">int</span> <span class="kw">and</span>  x <span class="op">&gt;=</span><span class="dv">10</span> <span class="cf">else</span> x)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ttc_lr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Route</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Incident</th>
<th data-quarto-table-cell-role="th">Min Delay</th>
<th data-quarto-table-cell-role="th">Min Gap</th>
<th data-quarto-table-cell-role="th">Date_</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>89</td>
<td>Monday</td>
<td>KEELE AND GLENLAKE</td>
<td>Vision</td>
<td>Short Delay</td>
<td>20</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>39</td>
<td>Monday</td>
<td>FINCH STATION</td>
<td>General Delay</td>
<td>Medium Delay</td>
<td>40</td>
<td>2024-01-01</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>320</td>
<td>Monday</td>
<td>YONGE AND QUEENSQUAY</td>
<td>Operations - Operator</td>
<td>Short Delay</td>
<td>16</td>
<td>2024-01-01</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>171</td>
<td>Monday</td>
<td>MOUNT DENNIS GARAGE</td>
<td>General Delay</td>
<td>Medium Delay</td>
<td>20</td>
<td>2024-01-01</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>12</td>
<td>Monday</td>
<td>VICTORIA PARK AND DANF</td>
<td>Emergency Services</td>
<td>Long Delay</td>
<td>42</td>
<td>2024-01-01</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35251</td>
<td>63</td>
<td>Monday</td>
<td>KING AND DOWLING</td>
<td>Vision</td>
<td>Short Delay</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35252</td>
<td>32</td>
<td>Monday</td>
<td>EGLINTON AND OAKWOOD</td>
<td>Vision</td>
<td>Medium Delay</td>
<td>18</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35253</td>
<td>63</td>
<td>Monday</td>
<td>OSSINGTON STATION</td>
<td>Vision</td>
<td>Short Delay</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35254</td>
<td>31</td>
<td>Monday</td>
<td>COXWELL STATION</td>
<td>Emergency Services</td>
<td>Medium Delay</td>
<td>34</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35255</td>
<td>54</td>
<td>Monday</td>
<td>ROGUE HILL GO STATION</td>
<td>Vision</td>
<td>Short Delay</td>
<td>20</td>
<td>2024-09-30</td>
<td>9</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>35256 rows × 9 columns</p>
</div>
</div>
</div>
<div id="260e80ec-6b95-4067-a0f3-29cfe8c8049b" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split dataset into target and features</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> ttc_lr[[<span class="st">"Route"</span>,<span class="st">"Incident"</span>,<span class="st">"Location"</span>,<span class="st">"Day"</span>,<span class="st">"Hour"</span>,<span class="st">"Month"</span>]]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ttc_lr[<span class="st">'Min Delay'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="289c7991-1903-41d8-ae27-3653ac825c39" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create types of features</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>numeric_features<span class="op">=</span>[<span class="st">"Hour"</span>,<span class="st">"Month"</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [<span class="st">'Location'</span>, <span class="st">'Route'</span>, <span class="st">'Incident'</span>,<span class="st">"Day"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cd2b0c27-6301-4511-9e56-c73db1dfabf3" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create transformers and preprocessing pipeline</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>   transformers<span class="op">=</span>[</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>       (<span class="st">'num'</span>, StandardScaler(), numeric_features),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>       (<span class="st">'cat'</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>), categorical_features)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>   ]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>preprocessor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<style>#sk-container-id-5 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-5 {
  color: var(--sklearn-color-text);
}

#sk-container-id-5 pre {
  padding: 0;
}

#sk-container-id-5 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-5 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-5 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-5 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-5 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-5 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-5 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-5 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-5 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-5 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-5 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-5 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-5 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-5 div.sk-label label.sk-toggleable__label,
#sk-container-id-5 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-5 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-5 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-5 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-5 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-5 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-5 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-5 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-5 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ColumnTransformer(transformers=[('num', StandardScaler(), ['Hour', 'Month']),
                                ('cat', OneHotEncoder(handle_unknown='ignore'),
                                 ['Location', 'Route', 'Incident', 'Day'])])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox"><label for="sk-estimator-id-28" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;&nbsp;ColumnTransformer<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for ColumnTransformer</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></label><div class="sk-toggleable__content "><pre>ColumnTransformer(transformers=[('num', StandardScaler(), ['Hour', 'Month']),
                                ('cat', OneHotEncoder(handle_unknown='ignore'),
                                 ['Location', 'Route', 'Incident', 'Day'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox"><label for="sk-estimator-id-29" class="sk-toggleable__label  sk-toggleable__label-arrow ">num</label><div class="sk-toggleable__content "><pre>['Hour', 'Month']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox"><label for="sk-estimator-id-30" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;StandardScaler<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content "><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox"><label for="sk-estimator-id-31" class="sk-toggleable__label  sk-toggleable__label-arrow ">cat</label><div class="sk-toggleable__content "><pre>['Location', 'Route', 'Incident', 'Day']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox"><label for="sk-estimator-id-32" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content "><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div id="1111f232-7f94-4f05-b1bb-5eaed4a7fc75" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create Model pipeline</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>model_pipeline <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>   (<span class="st">'preprocessor'</span>, preprocessor),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>   (<span class="st">'model'</span>, LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>, max_iter<span class="op">=</span><span class="dv">2000</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>model_pipeline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<style>#sk-container-id-6 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-6 {
  color: var(--sklearn-color-text);
}

#sk-container-id-6 pre {
  padding: 0;
}

#sk-container-id-6 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-6 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-6 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-6 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-6 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-6 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-6 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-6 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-6 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-6 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-6 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-6 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-6 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-6 div.sk-label label.sk-toggleable__label,
#sk-container-id-6 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-6 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-6 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-6 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-6 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-6 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-6 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-6 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-6 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-6 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num', StandardScaler(),
                                                  ['Hour', 'Month']),
                                                 ('cat',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['Location', 'Route',
                                                   'Incident', 'Day'])])),
                ('model', LogisticRegression(max_iter=2000, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox"><label for="sk-estimator-id-33" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></label><div class="sk-toggleable__content "><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num', StandardScaler(),
                                                  ['Hour', 'Month']),
                                                 ('cat',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['Location', 'Route',
                                                   'Incident', 'Day'])])),
                ('model', LogisticRegression(max_iter=2000, random_state=123))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox"><label for="sk-estimator-id-34" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;preprocessor: ColumnTransformer<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for preprocessor: ColumnTransformer</span></a></label><div class="sk-toggleable__content "><pre>ColumnTransformer(transformers=[('num', StandardScaler(), ['Hour', 'Month']),
                                ('cat', OneHotEncoder(handle_unknown='ignore'),
                                 ['Location', 'Route', 'Incident', 'Day'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox"><label for="sk-estimator-id-35" class="sk-toggleable__label  sk-toggleable__label-arrow ">num</label><div class="sk-toggleable__content "><pre>['Hour', 'Month']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox"><label for="sk-estimator-id-36" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;StandardScaler<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content "><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-37" type="checkbox"><label for="sk-estimator-id-37" class="sk-toggleable__label  sk-toggleable__label-arrow ">cat</label><div class="sk-toggleable__content "><pre>['Location', 'Route', 'Incident', 'Day']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-38" type="checkbox"><label for="sk-estimator-id-38" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content "><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-39" type="checkbox"><label for="sk-estimator-id-39" class="sk-toggleable__label  sk-toggleable__label-arrow ">&nbsp;LogisticRegression<a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content "><pre>LogisticRegression(max_iter=2000, random_state=123)</pre></div> </div></div></div></div></div></div>
</div>
</div>
<div id="912b5881-edf8-4c2d-9c1c-70e75b4fbd75" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split dataset into train and test data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Perform cross validation to see how the model performs</p>
<div id="d431e1d8-7bc5-4340-ab8f-ea2306e70c4a" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cv_pipe<span class="op">=</span>cross_validate(model_pipeline, X_train, y_train, cv<span class="op">=</span><span class="dv">5</span>, return_train_score<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>results_df<span class="op">=</span>pd.DataFrame(pd.DataFrame(cv_pipe))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fit_time</th>
<th data-quarto-table-cell-role="th">score_time</th>
<th data-quarto-table-cell-role="th">test_score</th>
<th data-quarto-table-cell-role="th">train_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.498094</td>
<td>0.010533</td>
<td>0.690480</td>
<td>0.772504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.542970</td>
<td>0.010509</td>
<td>0.699699</td>
<td>0.766387</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.548084</td>
<td>0.010670</td>
<td>0.689949</td>
<td>0.771617</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.532044</td>
<td>0.010995</td>
<td>0.683389</td>
<td>0.773878</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.571409</td>
<td>0.010146</td>
<td>0.702482</td>
<td>0.767550</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We then conduct hyperparameter tuning to optimize results, using a parameter grid of values of the hyperparameter C in the range <span class="math inline">\(10^{-5}\)</span> to <span class="math inline">\(10^{10}\)</span> and then using it in a Randomized Search.</p>
<div id="8d6b7a44-e7c2-43e8-a194-9716233bf91a" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>param_dist <span class="op">=</span> {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"model__C"</span>: [<span class="dv">10</span><span class="op">**</span>i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>)]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Grid size: </span><span class="sc">%d</span><span class="st">"</span> <span class="op">%</span> (np.prod(<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">len</span>, param_dist.values())))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grid size: 15</code></pre>
</div>
</div>
<div id="0c1518b7-e9ac-47a1-bdd3-68f38b2e1f59" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>random_search <span class="op">=</span> RandomizedSearchCV(model_pipeline,param_dist, n_iter<span class="op">=</span><span class="dv">15</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>,return_train_score<span class="op">=</span><span class="va">True</span>,random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>random_search.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<style>#sk-container-id-7 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-7 {
  color: var(--sklearn-color-text);
}

#sk-container-id-7 pre {
  padding: 0;
}

#sk-container-id-7 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-7 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-7 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-7 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-7 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-7 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-7 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-7 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-7 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-7 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-7 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-7 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-7 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-7 div.sk-label label.sk-toggleable__label,
#sk-container-id-7 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-7 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-7 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-7 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-7 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-7 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-7 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-7 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-7 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-7 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomizedSearchCV(estimator=Pipeline(steps=[('preprocessor',
                                              ColumnTransformer(transformers=[('num',
                                                                               StandardScaler(),
                                                                               ['Hour',
                                                                                'Month']),
                                                                              ('cat',
                                                                               OneHotEncoder(handle_unknown='ignore'),
                                                                               ['Location',
                                                                                'Route',
                                                                                'Incident',
                                                                                'Day'])])),
                                             ('model',
                                              LogisticRegression(max_iter=2000,
                                                                 random_state=123))]),
                   n_iter=15, n_jobs=-1,
                   param_distributions={'model__C': [1e-05, 0.0001, 0.001, 0.01,
                                                     0.1, 1, 10, 100, 1000,
                                                     10000, 100000, 1000000,
                                                     10000000, 100000000,
                                                     1000000000]},
                   random_state=123, return_train_score=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-40" type="checkbox"><label for="sk-estimator-id-40" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomizedSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.RandomizedSearchCV.html">?<span>Documentation for RandomizedSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomizedSearchCV(estimator=Pipeline(steps=[('preprocessor',
                                              ColumnTransformer(transformers=[('num',
                                                                               StandardScaler(),
                                                                               ['Hour',
                                                                                'Month']),
                                                                              ('cat',
                                                                               OneHotEncoder(handle_unknown='ignore'),
                                                                               ['Location',
                                                                                'Route',
                                                                                'Incident',
                                                                                'Day'])])),
                                             ('model',
                                              LogisticRegression(max_iter=2000,
                                                                 random_state=123))]),
                   n_iter=15, n_jobs=-1,
                   param_distributions={'model__C': [1e-05, 0.0001, 0.001, 0.01,
                                                     0.1, 1, 10, 100, 1000,
                                                     10000, 100000, 1000000,
                                                     10000000, 100000000,
                                                     1000000000]},
                   random_state=123, return_train_score=True)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-41" type="checkbox"><label for="sk-estimator-id-41" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num', StandardScaler(),
                                                  ['Hour', 'Month']),
                                                 ('cat',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['Location', 'Route',
                                                   'Incident', 'Day'])])),
                ('model',
                 LogisticRegression(C=1, max_iter=2000, random_state=123))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-42" type="checkbox"><label for="sk-estimator-id-42" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;preprocessor: ColumnTransformer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for preprocessor: ColumnTransformer</span></a></label><div class="sk-toggleable__content fitted"><pre>ColumnTransformer(transformers=[('num', StandardScaler(), ['Hour', 'Month']),
                                ('cat', OneHotEncoder(handle_unknown='ignore'),
                                 ['Location', 'Route', 'Incident', 'Day'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-43" type="checkbox"><label for="sk-estimator-id-43" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">num</label><div class="sk-toggleable__content fitted"><pre>['Hour', 'Month']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-44" type="checkbox"><label for="sk-estimator-id-44" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-45" type="checkbox"><label for="sk-estimator-id-45" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">cat</label><div class="sk-toggleable__content fitted"><pre>['Location', 'Route', 'Incident', 'Day']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-46" type="checkbox"><label for="sk-estimator-id-46" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content fitted"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-47" type="checkbox"><label for="sk-estimator-id-47" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=1, max_iter=2000, random_state=123)</pre></div> </div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<p>The selected model has the best train score with the smallest difference in train and validation scores, and indicating less overfitting. Thus the value of 0.1 is the value chosen for the final model.</p>
<div id="a7692d9e-8455-4f66-b5f3-5971f11cacd3" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>pd.DataFrame(pd.DataFrame(random_search.cv_results_).iloc[<span class="dv">4</span>])</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>b.T[[<span class="st">"params"</span>,<span class="st">"mean_train_score"</span>,<span class="st">"mean_test_score"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">params</th>
<th data-quarto-table-cell-role="th">mean_train_score</th>
<th data-quarto-table-cell-role="th">mean_test_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>{'model__C': 0.1}</td>
<td>0.717478</td>
<td>0.693342</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Create optimized pipiline with updated C</p>
<div id="07cea5b6-d64f-410f-ba11-245c644c5e55" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>optimized_pipe<span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>   (<span class="st">'preprocessor'</span>, preprocessor),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>   (<span class="st">'model'</span>, LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>, max_iter<span class="op">=</span><span class="dv">2000</span>,C<span class="op">=</span><span class="fl">0.1</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f80e5b5b-d546-4209-9868-306ae73a1bf4" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting the model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>optimized_pipe.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<style>#sk-container-id-8 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-8 {
  color: var(--sklearn-color-text);
}

#sk-container-id-8 pre {
  padding: 0;
}

#sk-container-id-8 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-8 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-8 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-8 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-8 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-8 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-8 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-8 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-8 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-8 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-8 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-8 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-8 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-8 div.sk-label label.sk-toggleable__label,
#sk-container-id-8 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-8 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-8 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-8 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-8 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-8 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-8 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-8 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-8 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-8 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num', StandardScaler(),
                                                  ['Hour', 'Month']),
                                                 ('cat',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['Location', 'Route',
                                                   'Incident', 'Day'])])),
                ('model',
                 LogisticRegression(C=0.1, max_iter=2000, random_state=123))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-48" type="checkbox"><label for="sk-estimator-id-48" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num', StandardScaler(),
                                                  ['Hour', 'Month']),
                                                 ('cat',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['Location', 'Route',
                                                   'Incident', 'Day'])])),
                ('model',
                 LogisticRegression(C=0.1, max_iter=2000, random_state=123))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-49" type="checkbox"><label for="sk-estimator-id-49" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;preprocessor: ColumnTransformer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for preprocessor: ColumnTransformer</span></a></label><div class="sk-toggleable__content fitted"><pre>ColumnTransformer(transformers=[('num', StandardScaler(), ['Hour', 'Month']),
                                ('cat', OneHotEncoder(handle_unknown='ignore'),
                                 ['Location', 'Route', 'Incident', 'Day'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-50" type="checkbox"><label for="sk-estimator-id-50" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">num</label><div class="sk-toggleable__content fitted"><pre>['Hour', 'Month']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-51" type="checkbox"><label for="sk-estimator-id-51" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-52" type="checkbox"><label for="sk-estimator-id-52" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">cat</label><div class="sk-toggleable__content fitted"><pre>['Location', 'Route', 'Incident', 'Day']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-53" type="checkbox"><label for="sk-estimator-id-53" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content fitted"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-54" type="checkbox"><label for="sk-estimator-id-54" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=0.1, max_iter=2000, random_state=123)</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p>Making predictions on the optimized model</p>
<div id="53a99103-d191-4b65-81c2-e3b8ad3e131d" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> optimized_pipe.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b3ad4db0-4d68-4ef6-b7f7-f3ef1e694988" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define order explicitly to reorder bars</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>order<span class="op">=</span>[<span class="st">"Short"</span>,<span class="st">"Medium"</span>,<span class="st">"Long"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create visualization for visually comparing the model performance.</p>
<div id="a394257c-5efe-499e-966b-538da3cd14b4" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>fig.set_dpi(<span class="dv">600</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>fig.set_label([<span class="st">"Actual Delays"</span>,<span class="st">"Predicted Delays"</span>])</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist( y_test, label<span class="op">=</span><span class="st">'Actual Delays'</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xticklabels(labels<span class="op">=</span>order)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist( predictions, label<span class="op">=</span><span class="st">'Predicted Delays'</span>,color<span class="op">=</span><span class="st">"orange"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xticklabels(labels<span class="op">=</span>order)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>fig.legend(loc<span class="op">=</span><span class="st">"upper left"</span>,bbox_to_anchor<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">1.05</span>))</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Comparison of Actual vs. Predicted Delays'</span>, y<span class="op">=</span><span class="fl">1.12</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"Comparison.png"</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m3/7mxrzzgs65x1zsl77zk_xn640000gn/T/ipykernel_5645/2532171593.py:5: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax[0].set_xticklabels(labels=order)
/var/folders/m3/7mxrzzgs65x1zsl77zk_xn640000gn/T/ipykernel_5645/2532171593.py:8: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax[1].set_xticklabels(labels=order)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/cell-40-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="373f5bfa" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>y1<span class="op">=</span>y_test.to_list()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="93a4f932" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cm<span class="op">=</span>confusion_matrix(y1,predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0371e5c0" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fig1<span class="op">=</span>ConfusionMatrixDisplay.from_predictions(y1,predictions,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                              cmap<span class="op">=</span><span class="st">'Blues_r'</span>).figure_.set_dpi(<span class="dv">800</span>).savefig(<span class="st">"ConfusionMat.png"</span>,transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>fig1.savefig(<span class="st">"ConfusionMat.png"</span>,transparent<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[162], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> fig1<span style="color:rgb(98,98,98)">=</span><span class="ansi-yellow-bg">ConfusionMatrixDisplay</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">from_predictions</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">y1</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">predictions</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">                              </span><span class="ansi-yellow-bg">cmap</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">Blues_r</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">figure_</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">set_dpi</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">800</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">savefig</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">ConfusionMat.png</span><span style="color:rgb(175,0,0)">"</span>,transparent<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)
<span class="ansi-green-fg ansi-bold">      3</span> fig1<span style="color:rgb(98,98,98)">.</span>savefig(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">ConfusionMat.png</span><span style="color:rgb(175,0,0)">"</span>,transparent<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">AttributeError</span>: 'NoneType' object has no attribute 'savefig'</pre>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/cell-43-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="18b86bd7" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>fig1.savefig(<span class="st">"ConfusionMat.png"</span>,transparent<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[160], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">fig1</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">savefig</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">ConfusionMat.png</span><span style="color:rgb(175,0,0)">"</span>,transparent<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">AttributeError</span>: 'NoneType' object has no attribute 'savefig'</pre>
</div>
</div>
</div>
<div id="ae0d2e8c" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure(51.2x38.4)</code></pre>
</div>
</div>
</section>
<section id="discussion-of-results" class="level2">
<h2 class="anchored" data-anchor-id="discussion-of-results">Discussion of Results</h2>
<p>The EDA analysis of the TTC bus delay data uncovers several key insights. The distribution of delays is significantly biased towards shorter durations, with the majority of delays lasting less than 20 minutes. This indicates that although delays occur frequently, they are typically short and manageable.</p>
<p>Kennedy Station stands out as the site with the highest number of delays, suggesting that either infrastructural limitations or a high volume of passengers are contributing to these frequent interruptions. The analysis of delay counts by day of the week indicates that Tuesday through Friday are the days with the highest delays, suggesting a potential correlation with weekday commuter traffic.</p>
<p>Mechanical issues are the primary cause of delays, comprising a substantial portion, followed by operator-related operations and diversions. This finding indicates potential areas for intervention, such as improved maintenance or optimized scheduling, to mitigate delay incidents.</p>
<p>The results of the logistic regression model show moderate effectiveness in predicting delay durations. Predicted frequencies for short and medium delays correspond with actual data; however, the model underpredicts long delays, highlighting the complexity of accurately capturing extended durations and their contributing factors. We could explore more advanced predictive models to improve accuracy. Furthermore, more data integration such as weather conditions could enhance model performance.</p>
<p>Data Validation</p>
<div id="87c8c371-8a61-4024-acbd-e0585ab242b9" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct data file format</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">'../data/ttc-bus-delay-data-2024.csv'</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.exists(file_path) <span class="kw">and</span> file_path.endswith(<span class="st">'.csv'</span>):</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load the CSV file and parse dates</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>        ttc <span class="op">=</span> pd.read_csv(file_path, parse_dates<span class="op">=</span>[<span class="st">'Date'</span>])</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"File loaded successfully!"</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error loading file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error: File is either missing or not in CSV format."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>File loaded successfully!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m3/7mxrzzgs65x1zsl77zk_xn640000gn/T/ipykernel_40993/4209968046.py:11: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  ttc = pd.read_csv(file_path, parse_dates=['Date'])</code></pre>
</div>
</div>
<p>The warning suggests that the pd.read_csv() method couldn’t infer a uniform date format for the Date column. This happens when the column contains inconsistent date formats or unparseable values. This was fixed when we used parse_dates=[‘Date’] in ttc = pd.read_csv(‘data/ttc-bus-delay-data-2024.csv’, parse_dates=[‘Date’])</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>